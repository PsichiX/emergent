<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js ayu">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>First steps - Emergent AI - Smart agents and events for games</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "ayu";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('ayu')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="first_steps.html" class="active"><strong aria-hidden="true">2.</strong> First steps</a></li><li class="chapter-item expanded "><a href="decision_makers/introduction.html"><strong aria-hidden="true">3.</strong> Decision makers</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="decision_makers/finite_state_machine/introduction.html"><strong aria-hidden="true">3.1.</strong> Finite State Machine</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="decision_makers/finite_state_machine/explanation.html"><strong aria-hidden="true">3.1.1.</strong> How it works</a></li><li class="chapter-item expanded "><a href="decision_makers/finite_state_machine/implementation.html"><strong aria-hidden="true">3.1.2.</strong> How to implement</a></li><li class="chapter-item expanded "><a href="decision_makers/finite_state_machine/use_of_machinery.html"><strong aria-hidden="true">3.1.3.</strong> Use of Machinery decision maker from emergent crate</a></li><li class="chapter-item expanded "><a href="decision_makers/finite_state_machine/usecases.html"><strong aria-hidden="true">3.1.4.</strong> Typical use cases</a></li></ol></li><li class="chapter-item expanded "><a href="decision_makers/hierarchical_finite_state_machine/introduction.html"><strong aria-hidden="true">3.2.</strong> Hierarchical Finite State Machine</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="decision_makers/hierarchical_finite_state_machine/explanation.html"><strong aria-hidden="true">3.2.1.</strong> How it works</a></li><li class="chapter-item expanded "><a href="decision_makers/hierarchical_finite_state_machine/implementation.html"><strong aria-hidden="true">3.2.2.</strong> How to implement</a></li><li class="chapter-item expanded "><a href="decision_makers/hierarchical_finite_state_machine/use_of_machinery.html"><strong aria-hidden="true">3.2.3.</strong> Hierarchical use of Machinery decision maker from emergent crate</a></li><li class="chapter-item expanded "><a href="decision_makers/hierarchical_finite_state_machine/usecases.html"><strong aria-hidden="true">3.2.4.</strong> Typical use cases</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.3.</strong> Utility AI</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.4.</strong> Behavior Tree</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">3.5.</strong> Goal Oriented Action Planning</div></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.</strong> Common AI problems and solutions</div></li><li><ol class="section"><li class="chapter-item expanded "><div><strong aria-hidden="true">4.1.</strong> NPC day cycle</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.2.</strong> Steering</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.3.</strong> Crowd movement</div></li><li class="chapter-item expanded "><div><strong aria-hidden="true">4.4.</strong> Crowds shared behavior</div></li></ol></li><li class="chapter-item expanded "><a href="more.html"><strong aria-hidden="true">5.</strong> More...</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu (default)</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Emergent AI - Smart agents and events for games</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="first-steps"><a class="header" href="#first-steps">First steps</a></h1>
<h2 id="first-of-all-what-do-we-mean-by-the-term-ai"><a class="header" href="#first-of-all-what-do-we-mean-by-the-term-ai">First of all: what do we mean by the term AI?</a></h2>
<p>When we talk about AI for games, we are in fact talking about all decision making
units of logic.</p>
<p>It's improtant to understand that decision making, or AI, isn't suited only for
agents in the game - it can be and already is widely used for animation systems,
events happening in game world, or even to control sounds and music.</p>
<h2 id="you-are-probably-already-making-an-ai-system-without-even-noticing-it-right-now"><a class="header" href="#you-are-probably-already-making-an-ai-system-without-even-noticing-it-right-now">You are probably already making an AI system without even noticing it right now!</a></h2>
<p>For a moment let's try to write a simple enemy wandering code the way we usually do.</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>enum Direction {
  Up,
  Down,
  Left,
  Right,
}

impl Direction {
  fn horizontal(&amp;self) -&gt; isize {
    match self {
      Self::Left =&gt; -1,
      Self::Right =&gt; 1,
      _ =&gt; 0,
    }
  }

  fn vertical(&amp;self) -&gt; isize {
    match self {
      Self::Up =&gt; -1,
      Self::Down =&gt; 1,
      _ =&gt; 0,
    }
  }

  fn next(&amp;self) -&gt; Self {
    match self {
      Self::Up =&gt; Self::Right,
      Self::Down =&gt; Self::Left,
      Self::Left =&gt; Self::Up,
      Self::Right =&gt; Self::Down,
    }
  }
}

struct Enemy {
  position: (isize, isize),
  direction: Direction,
  change_direction_turns: usize,
  wait_turns: usize,
}

impl Enemy {
  fn new(x: isize, y: isize) -&gt; Self {
    Self {
      position: (x, y),
      direction: Direction::Up,
      change_direction_turns: 0,
      wait_turns: 0,
    }
  }

  fn update(&amp;mut self) {
    if self.wait_turns &gt; 0 {
      self.wait_turns -= 1;
    } else if self.change_direction_turns &gt; 0 {
      self.change_direction_turns -= 1;
      self.position.0 += self.direction.horizontal();
      self.position.1 += self.direction.vertical();
    } else {
      self.direction = self.direction.next();
      self.change_direction_turns = 4;
      self.wait_turns = 2;
    }
  }
}
<span class="boring">}
</span></code></pre></pre>
<p>You can notice <code>update</code> function - this is what controls this enemy simple AI.
You might not have noticed it but you have used Finite State Machine for this
problem, hardcore way thought.</p>
<p>Btw. That snippet was really hard to read, right? Yeah, that's how our naive
&quot;simple&quot; AI implementations usually end up growing in complexity.</p>
<p>We can do better, let me refactor it to prove it to you:</p>
<pre><pre class="playground"><code class="language-rust">
<span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span><span class="boring">enum Direction {
</span><span class="boring">  Up,
</span><span class="boring">  Down,
</span><span class="boring">  Left,
</span><span class="boring">  Right,
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">impl Direction {
</span><span class="boring">  fn horizontal(&amp;self) -&gt; isize {
</span><span class="boring">    match self {
</span><span class="boring">      Self::Left =&gt; -1,
</span><span class="boring">      Self::Right =&gt; 1,
</span><span class="boring">      _ =&gt; 0,
</span><span class="boring">    }
</span><span class="boring">  }
</span><span class="boring">
</span><span class="boring">  fn vertical(&amp;self) -&gt; isize {
</span><span class="boring">    match self {
</span><span class="boring">      Self::Up =&gt; -1,
</span><span class="boring">      Self::Down =&gt; 1,
</span><span class="boring">      _ =&gt; 0,
</span><span class="boring">    }
</span><span class="boring">  }
</span><span class="boring">
</span><span class="boring">  fn next(&amp;self) -&gt; Self {
</span><span class="boring">    match self {
</span><span class="boring">      Self::Up =&gt; Self::Right,
</span><span class="boring">      Self::Down =&gt; Self::Left,
</span><span class="boring">      Self::Left =&gt; Self::Up,
</span><span class="boring">      Self::Right =&gt; Self::Down,
</span><span class="boring">    }
</span><span class="boring">  }
</span><span class="boring">}
</span><span class="boring">
</span>enum State {
  Wait(usize),
  ChangeDirection,
  Move(usize),
}

struct Enemy {
  position: (isize, isize),
  direction: Direction,
  state: State,
}

impl Enemy {
  fn new(x: isize, y: isize) -&gt; Self {
    Self {
      position: (x, y),
      direction: Direction::Up,
      state: State::ChangeDirection,
    }
  }

  fn update(&amp;mut self) {
    match &amp;mut self.state {
      State::Wait(turns) =&gt; {
        if *turns &gt; 0 {
          *turns -= 1;
        } else {
          self.state = State::ChangeDirection;
        }
      },
      State::ChangeDirection =&gt; {
        self.direction = self.direction.next();
        self.state = State::Move(4);
      },
      State::Move(turns) =&gt; {
        if *turns &gt; 0 {
          *turns -= 1;
          self.position.0 += self.direction.horizontal();
          self.position.1 += self.direction.vertical();
        } else {
          self.state = State::Wait(2);
        }
      },
    }
  }
}
<span class="boring">}
</span></code></pre></pre>
<p>Now we can clearly see what is the actual behavior of this AI:</p>
<ul>
<li>wait few turns</li>
<li>change direction</li>
<li>move forward for few turns</li>
</ul>
<p>And we have got rid of a bug where our previous magic didn't actually do what we
aimed for the way we wanted it to do. This is the simplest state machine we have
learned to make, most likely at this point you're already making them this way.</p>
<p>Now imagine we get more states to handle, like shooting, taking cover when on
low health, finding ammo when it ends - number of state changes and branching
grows exponentially with number of states and our code starts to look more like
a spaghetti than code with clear and easily understandable intent. Have you
encountered that frustration yet?</p>
<p>This is the exact reason why AI systems have been invented in first place - to
simplify readability of and iteration over AI logic.</p>
<p>In next chapters we will learn about AI systems and gradually work our way out
from naive AI logic to more managable solutions.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="introduction.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="decision_makers/introduction.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="introduction.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="decision_makers/introduction.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
